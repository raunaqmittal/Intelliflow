===================================================================================
                        INTELLIFLOW - COMPREHENSIVE TEST CASES
===================================================================================

This document lists all test cases for the Intelliflow project management system,
organized by completion status: FULFILLED tests first, then PENDING tests.

Last Updated: December 1, 2025

===================================================================================
                          SECTION 1: FULFILLED TEST CASES
===================================================================================

These test cases have been implemented, automated, and validated.

------------------------------------------------------------------------------------
A. INPUT VALIDATION - PHONE NUMBER
------------------------------------------------------------------------------------
[‚úì] TC-001: Phone number in E.164 format (+1234567890) - ACCEPTED
    Location: employeeModel.js line 55-64, clientModel.js line 27-37
    Regex: /^\+?[1-9]\d{9,14}$/
    Test: backendTesting.js step 20-21, frontendTesting.cjs client step 9

[‚úì] TC-002: Phone number without country code prefix - REJECTED
    Validation: Must start with +[1-9]
    Error: "Phone number must be in E.164 format (e.g., +1234567890)"

[‚úì] TC-003: Phone number with less than 10 digits - REJECTED
    Validation: Minimum 10 digits (9 after country code)
    Error: "Phone number must be in E.164 format (e.g., +1234567890)"

[‚úì] TC-004: Phone number with more than 15 digits - REJECTED
    Validation: Maximum 15 digits (14 after country code)
    Error: "Phone number must be in E.164 format (e.g., +1234567890)"

[‚úì] TC-005: Phone number with special characters (spaces, dashes) - REJECTED
    Validation: Only digits and optional + prefix
    Error: "Phone number must be in E.164 format (e.g., +1234567890)"

[‚úì] TC-006: Phone number starting with 0 after + - REJECTED
    Validation: Must start with +[1-9] after +
    Error: "Phone number must be in E.164 format (e.g., +1234567890)"

------------------------------------------------------------------------------------
B. INPUT VALIDATION - EMAIL ADDRESS
------------------------------------------------------------------------------------
[‚úì] TC-007: Valid email format (user@domain.com) - ACCEPTED
    Location: employeeModel.js line 41, clientModel.js line 21
    Library: validator.isEmail

[‚úì] TC-008: Email without @ symbol - REJECTED
    Error: "Please provide a valid email"

[‚úì] TC-009: Email without domain (.com, .org) - REJECTED
    Error: "Please provide a valid email"

[‚úì] TC-010: Email with spaces - REJECTED
    Error: "Please provide a valid email"

[‚úì] TC-011: Email uniqueness constraint - REJECTED if duplicate
    Note: Employee emails are unique, client contact_email is unique
    Error: "Duplicate field values. Please use another value!"

------------------------------------------------------------------------------------
C. INPUT VALIDATION - PASSWORD
------------------------------------------------------------------------------------
[‚úì] TC-012: Password with 8+ characters - ACCEPTED
    Location: employeeModel.js line 94-107, clientModel.js line 64-77
    Validation: minlength: 8

[‚úì] TC-013: Password with less than 8 characters - REJECTED
    Error: "Password must be at least 8 characters long"

[‚úì] TC-014: Password and passwordConfirm match - ACCEPTED
    Validation: Custom validator comparing password and passwordConfirm

[‚úì] TC-015: Password and passwordConfirm mismatch - REJECTED
    Error: "Passwords do not match"

[‚úì] TC-016: Missing passwordConfirm field - REJECTED
    Error: "Please confirm your password!"

[‚úì] TC-017: Password encryption with bcrypt - VERIFIED
    Location: employeeModel.js line 115-121, clientModel.js line 85-91
    Algorithm: bcrypt with cost factor 12

------------------------------------------------------------------------------------
D. OTP VALIDATION AND SECURITY
------------------------------------------------------------------------------------
[‚úì] TC-018: Valid 6-digit OTP - ACCEPTED
    Location: Back End/Utilities/otp.js
    Format: Numeric, 6 digits

[‚úì] TC-019: Invalid OTP (wrong digits) - REJECTED
    Test: backendTesting.js step 21, frontendTesting.cjs all portals
    Error: "Invalid OTP. Please try again."

[‚úì] TC-020: Expired OTP (>5 minutes) - REJECTED
    Expiry: 5 minutes (OTP_EXPIRY_MINUTES)
    Error: "OTP has expired. Please request a new one."

[‚úì] TC-021: OTP rate limiting (request within 2 minutes) - REJECTED
    Rate Limit: 2 minutes between requests (OTP_RATE_LIMIT_MINUTES)
    Error: "Please wait before requesting a new OTP"

[‚úì] TC-022: OTP max attempts exceeded (>3 attempts) - REJECTED
    Max Attempts: 3
    Error: "Too many failed attempts. Please request a new OTP."

[‚úì] TC-023: OTP hashing with SHA-256 - VERIFIED
    Location: otp.js hashOTP function
    Security: OTP stored hashed in database (select: false)

[‚úì] TC-024: OTP cleared after successful verification - VERIFIED
    Fields cleared: otpCode, otpExpires, otpAttempts, otpLastSent

[‚úì] TC-025: Frontend 6-digit OTP input validation - VERIFIED
    Test: frontendTesting.cjs validates OTP format before submission

------------------------------------------------------------------------------------
E. AUTHENTICATION - SIGNUP
------------------------------------------------------------------------------------
[‚úì] TC-026: Employee signup with valid data - SUCCESS
    Test: frontendTesting.cjs employee portal step 1-2
    Returns: JWT token, employee data

[‚úì] TC-027: Client signup with valid data - SUCCESS
    Test: frontendTesting.cjs client portal step 1-2
    Returns: JWT token, client data

[‚úì] TC-028: Signup with duplicate email - REJECTED
    Error: "Duplicate field values. Please use another value!"

[‚úì] TC-029: Signup with invalid phone format - REJECTED
    Error: "Phone number must be in E.164 format"

[‚úì] TC-030: Signup with password < 8 characters - REJECTED
    Error: "Password must be at least 8 characters long"

[‚úì] TC-031: Signup with mismatched passwords - REJECTED
    Error: "Passwords do not match"

[‚úì] TC-032: JWT token stored in HTTP-only cookie - VERIFIED
    Location: authController.js line 23-28
    Flags: httpOnly, sameSite: strict, secure (production only)

------------------------------------------------------------------------------------
F. AUTHENTICATION - LOGIN
------------------------------------------------------------------------------------
[‚úì] TC-033: Employee login with valid credentials - SUCCESS
    Test: frontendTesting.cjs employee portal step 3
    Returns: JWT token

[‚úì] TC-034: Client login with valid credentials - SUCCESS
    Test: frontendTesting.cjs client portal step 3
    Returns: JWT token

[‚úì] TC-035: Login with incorrect email - REJECTED
    Error: "Incorrect email or password"

[‚úì] TC-036: Login with incorrect password - REJECTED
    Error: "Incorrect email or password"

[‚úì] TC-037: Login rate limiting in production (5 attempts/15 min) - ENFORCED
    Location: app.js line 91-95
    Production: 5 attempts per 15 minutes
    Development: 50 attempts per 15 minutes

[‚úì] TC-038: Employee login with 2FA enabled requires OTP - VERIFIED
    Flow: Login -> OTP sent via SMS -> Verify OTP -> Token issued

[‚úì] TC-039: Client login with 2FA enabled requires OTP - VERIFIED
    Flow: Login -> OTP sent via SMS -> Verify OTP -> Token issued

------------------------------------------------------------------------------------
G. TWO-FACTOR AUTHENTICATION (2FA)
------------------------------------------------------------------------------------
[‚úì] TC-040: Enable 2FA without phone number - REJECTED
    Location: employeeController.js line 174-180, clientController.js line 93-99
    Error: "Phone number is required to enable 2FA"

[‚úì] TC-041: Enable 2FA without verified phone - REJECTED
    Location: employeeController.js line 182-188, clientController.js line 101-107
    Error: "Please verify your phone number first"

[‚úì] TC-042: Enable 2FA with verified phone - SUCCESS
    Test: backendTesting.js, frontendTesting.cjs
    Result: twoFactorEnabled = true

[‚úì] TC-043: Disable 2FA - SUCCESS
    Result: twoFactorEnabled = false

[‚úì] TC-044: Phone number change auto-disables 2FA - VERIFIED
    Location: employeeController.js line 147-162, clientController.js line 64-79
    Auto-disabled: twoFactorEnabled = false, phoneVerified = false

[‚úì] TC-045: 2FA login flow with valid OTP - SUCCESS
    Steps: Login -> Send OTP -> Verify OTP -> Token issued

[‚úì] TC-046: 2FA login flow with invalid OTP - REJECTED
    Error: "Invalid OTP. Please try again."

[‚úì] TC-047: 2FA login flow with expired OTP - REJECTED
    Error: "OTP has expired. Please request a new one."

------------------------------------------------------------------------------------
H. PHONE VERIFICATION
------------------------------------------------------------------------------------
[‚úì] TC-048: Send phone verification OTP - SUCCESS
    Test: backendTesting.js step 20, frontendTesting.cjs all portals
    Twilio SMS sent (or console log in dev mode)

[‚úì] TC-049: Verify phone with correct OTP - SUCCESS
    Test: backendTesting.js step 20, frontendTesting.cjs all portals
    Result: phoneVerified = true

[‚úì] TC-050: Verify phone with incorrect OTP - REJECTED
    Test: backendTesting.js step 21, frontendTesting.cjs all portals
    Error: "Invalid OTP. Please try again."

[‚úì] TC-051: Phone change resets verification status - VERIFIED
    Result: phoneVerified = false, OTP fields cleared
    Security: Changing phone invalidates pending OTP verification

[‚úì] TC-052: OTP masking in logs - VERIFIED
    Only last 4 digits shown in development logs

------------------------------------------------------------------------------------
I. PASSWORD RESET
------------------------------------------------------------------------------------
[‚úì] TC-053: Forgot password with valid email - SUCCESS
    Flow: Email submitted -> OTP sent -> Verify OTP -> Reset allowed

[‚úì] TC-054: Forgot password with non-existent email - REJECTED
    Error: "There is no user with that email address"

[‚úì] TC-055: Verify reset OTP with correct code - SUCCESS
    Returns: Reset token

[‚úì] TC-056: Verify reset OTP with incorrect code - REJECTED
    Error: "Invalid OTP. Please try again."

[‚úì] TC-057: Verify reset OTP with expired code - REJECTED
    Error: "OTP has expired. Please request a new one."

[‚úì] TC-058: Reset password with valid token and matching passwords - SUCCESS
    Result: Password updated, user logged in

[‚úì] TC-059: Reset password with mismatched passwords - REJECTED
    Error: "Passwords do not match"

------------------------------------------------------------------------------------
J. AUTHORIZATION - ROLE-BASED ACCESS CONTROL
------------------------------------------------------------------------------------
[‚úì] TC-060: Employee accessing employee-only routes - ALLOWED
    Protected by: protect middleware

[‚úì] TC-061: Client accessing client-only routes - ALLOWED
    Protected by: protect middleware

[‚úì] TC-062: Manager accessing manager-only routes - ALLOWED
    Protected by: protect + restrictTo('manager')
    Routes: requestRoutes.js lines 29, 36, 43, 50, 56, 62, 68, 74

[‚úì] TC-063: Employee accessing manager-only routes - REJECTED
    Error: "You do not have permission to perform this action"

[‚úì] TC-064: Client accessing employee routes - REJECTED
    Error: "You are not logged in! Please log in to get access."

[‚úì] TC-065: Unauthenticated user accessing protected routes - REJECTED
    Error: "You are not logged in! Please log in to get access."

------------------------------------------------------------------------------------
K. AUTHORIZATION - DEPARTMENT-BASED APPROVAL
------------------------------------------------------------------------------------
[‚úì] TC-066: Manager approving request in their department - ALLOWED
    Validation: Department match required

[‚úì] TC-067: Manager rejecting request in their department - ALLOWED
    Test: backendTesting.js step 22-23
    Result: rejectedBy includes department

[‚úì] TC-068: Manager toggling department approval decisions - ALLOWED
    Can reject then re-approve same request

[‚úì] TC-069: Manager with isApprover=false attempting approval - REJECTED
    Validation: Requires isApprover flag

------------------------------------------------------------------------------------
L. SECURITY - XSS AND INJECTION PROTECTION
------------------------------------------------------------------------------------
[‚úì] TC-070: NoSQL injection attempt in query - SANITIZED
    Location: app.js line 49
    Library: express-mongo-sanitize

[‚úì] TC-071: XSS attack attempt in input - SANITIZED
    Location: app.js line 52
    Library: xss-clean

[‚úì] TC-072: HTTP header security - ENFORCED
    Location: app.js line 30
    Library: helmet

[‚úì] TC-073: CSRF protection via SameSite cookie - ENFORCED
    Location: authController.js line 25
    Setting: sameSite: 'strict'

[‚úì] TC-074: Parameter pollution prevention - ENFORCED
    Location: app.js line 54-62
    Library: hpp

------------------------------------------------------------------------------------
M. SECURITY - RATE LIMITING
------------------------------------------------------------------------------------
[‚úì] TC-075: API rate limit (100 requests/hour) - ENFORCED
    Location: app.js line 79-83
    Limit: 100 requests per hour per IP

[‚úì] TC-076: Auth rate limit development (50/15 min) - ENFORCED
    Location: app.js line 88-93
    Applies to: login, signup, forgotPassword

[‚úì] TC-077: Auth rate limit production (5/15 min) - ENFORCED
    Location: app.js line 88-93
    Stricter limit for production

------------------------------------------------------------------------------------
N. ERROR HANDLING
------------------------------------------------------------------------------------
[‚úì] TC-078: Development mode shows full error stack - VERIFIED
    Location: errorController.js sendErrorDev function
    Returns: status, error, stack, message

[‚úì] TC-079: Production mode shows generic errors - VERIFIED
    Location: errorController.js sendErrorProd function
    Returns: Generic message for non-operational errors

[‚úì] TC-080: CastError (invalid MongoDB ObjectId) - HANDLED
    Error: "Invalid _id: <value>"

[‚úì] TC-081: Duplicate field error (MongoDB 11000) - HANDLED
    Error: "Duplicate field values. Please use another value!"

[‚úì] TC-082: Validation error (Mongoose) - HANDLED
    Error: "Invalid Input Data. <details>"

[‚úì] TC-083: Invalid JWT token - HANDLED
    Error: "Invalid token. Please log in again!"

[‚úì] TC-084: Expired JWT token - HANDLED
    Error: "Your token has expired! Please log in again."

------------------------------------------------------------------------------------
O. FRONTEND - STATE MANAGEMENT
------------------------------------------------------------------------------------
[‚úì] TC-085: Login persists user state in localStorage - VERIFIED
    Location: UserContext.tsx
    Stored: authToken, employeeProfile, lastUserRole

[‚úì] TC-086: Logout clears all user state - VERIFIED
    Cleared: authToken, employeeProfile, lastUserRole

[‚úì] TC-087: Token included in API requests via interceptor - VERIFIED
    Location: Front End/src/lib/api.ts
    Header: Authorization: Bearer <token>

[‚úì] TC-088: 401 error triggers automatic logout - VERIFIED
    Location: api.ts response interceptor

[‚úì] TC-089: UserContext updates on profile changes - VERIFIED
    Function: updateEmployee in UserContext.tsx

------------------------------------------------------------------------------------
P. FRONTEND - PHONE VERIFICATION UI
------------------------------------------------------------------------------------
[‚úì] TC-090: Phone input field validates E.164 format - VERIFIED
    Placeholder guides users to correct format

[‚úì] TC-091: Send OTP button disabled during API call - VERIFIED
    Prevents duplicate requests

[‚úì] TC-092: OTP input accepts only 6 digits - VERIFIED
    Frontend validation before submission

[‚úì] TC-093: Verify button disabled until 6 digits entered - VERIFIED
    UI validation

[‚úì] TC-094: Success message after phone verification - VERIFIED
    Toast notification displayed

[‚úì] TC-095: Error message on verification failure - VERIFIED
    Toast notification with error details

------------------------------------------------------------------------------------
Q. PROFILE UPDATES
------------------------------------------------------------------------------------
[‚úì] TC-096: Employee profile update with valid data - SUCCESS
    Test: frontendTesting.cjs employee portal
    Updates reflected in database and frontend

[‚úì] TC-097: Client profile update with valid data - SUCCESS
    Test: frontendTesting.cjs client portal
    Updates reflected in database and frontend

[‚úì] TC-098: Manager profile update with phone number - SUCCESS
    Test: frontendTesting.cjs manager portal step 18
    Phone field included in update request

[‚úì] TC-099: Profile update with invalid phone format - REJECTED
    Error: "Phone number must be in E.164 format"

[‚úì] TC-100: Phone update clears verification and disables 2FA - VERIFIED
    Automatic: phoneVerified = false, twoFactorEnabled = false

------------------------------------------------------------------------------------
R. TESTING INFRASTRUCTURE
------------------------------------------------------------------------------------
[‚úì] TC-101: Backend smoke testing with temp data - SUCCESS
    Script: npm run test-backend smoke
    Coverage: All major endpoints

[‚úì] TC-102: Backend specific testing with real IDs - SUCCESS
    Script: npm run test-backend specific
    Tests specific employee/client workflows

[‚úì] TC-103: Frontend client portal testing - SUCCESS
    Script: npm run test-frontend client
    Coverage: Signup, login, profile, phone verification

[‚úì] TC-104: Frontend employee portal testing - SUCCESS
    Script: npm run test-frontend employee
    Coverage: Signup, login, profile, phone verification

[‚úì] TC-105: Frontend manager portal testing - SUCCESS
    Script: npm run test-frontend manager
    Coverage: Login, profile, phone verification, department approvals

------------------------------------------------------------------------------------
S. EDGE CASE VALIDATION - CONCURRENT OPERATIONS
------------------------------------------------------------------------------------
[‚úì] TC-210: Profile update while OTP verification pending - SUCCESS
    Test: Send OTP -> Update name -> Verify OTP
    Expected: OTP verification succeeds, profile updated
    Result: Profile update works concurrently with OTP flow
    Validated: Automated test script (edgeCaseTesting.js)

------------------------------------------------------------------------------------
T. EDGE CASE VALIDATION - NETWORK AND CONNECTIVITY
------------------------------------------------------------------------------------
[‚úì] TC-213: API request during network disconnection - HANDLED
    Test: Disconnect network -> Submit form
    Expected: Error message "Network error" displayed
    Fix: Added 15s timeout + network error handling in api.ts

[‚úì] TC-214: Partial response from server (connection interrupted) - HANDLED
    Test: Slow connection -> Interrupt during response
    Expected: Error caught, user notified
    Fix: Axios interceptor catches interrupted connections

[‚úì] TC-215: API timeout (slow server response) - HANDLED
    Test: Very slow API endpoint
    Expected: Timeout after configured duration, error shown
    Fix: 15s timeout configured, shows "Request timeout" message

[‚úì] TC-216: Reconnection after network restored - HANDLED
    Test: Disconnect -> Attempt action -> Reconnect -> Retry
    Expected: Request succeeds after reconnection
    Fix: Each request is independent, no cached error state

------------------------------------------------------------------------------------
U. EDGE CASE VALIDATION - TWILIO AND SMS
------------------------------------------------------------------------------------
[‚úì] TC-219: Phone number not registered with Twilio (dev mode) - HANDLED
    Test: Use unverified number with trial account
    Expected: Development mode logs OTP to console
    Result: OTP system working with updated credentials

[‚úì] TC-220: International phone numbers with various country codes - SUCCESS
    Test: +44, +91, +81, +86 etc.
    Expected: All valid E.164 formats accepted
    Result: E.164 regex accepts all standard country codes

------------------------------------------------------------------------------------
V. EDGE CASE VALIDATION - DATABASE AND DATA INTEGRITY
------------------------------------------------------------------------------------
[‚úì] TC-222: Phone uniqueness in production - VALIDATED
    Test: Sign up two users with same phone
    Expected: Second signup fails with duplicate error
    Result: Uniqueness constraint enforced correctly
    Note: ENABLED IN DEV, MUST ENABLE IN PRODUCTION
    Location: employeeModel.js line 58, clientModel.js line 30

[‚úì] TC-226: Orphaned OTP records (user never verifies) - HANDLED
    Test: Request many OTPs -> Never verify
    Expected: Old OTPs auto-cleared or expired
    Result: OTP records stored with expiry timestamps, auto-expire

------------------------------------------------------------------------------------
W. EDGE CASE VALIDATION - AUTHORIZATION
------------------------------------------------------------------------------------
[‚úì] TC-228: Token manipulation (modified JWT) - PROTECTED
    Test: Manually alter JWT token -> Make API request
    Expected: Rejected with "Invalid token" error
    Result: Manipulated tokens correctly rejected with "invalid signature"

[‚úì] TC-230: Role escalation attempt (employee to manager) - PROTECTED
    Test: Modify localStorage role -> Access manager routes
    Expected: Backend rejects based on DB role
    Result: Role escalation prevented - permission denied error

[‚úì] TC-232: Phone change during OTP verification - PROTECTED
    Test: Send OTP -> Change phone number -> Verify old OTP
    Expected: Verification rejected, error "Phone number has changed"
    Result: OTP invalidated when phone changes, prevents verification of wrong number
    Location: employeeController.js verifyPhone, clientController.js verifyPhone
    Security: otpPhone field tracks which number OTP was sent to

------------------------------------------------------------------------------------
X. EDGE CASE VALIDATION - INPUT VALIDATION
------------------------------------------------------------------------------------
[‚úì] TC-233: Email with international characters (IDN) - SUCCESS
    Test: user@m√ºnchen.de or user@‰∏≠ÂõΩ.com
    Expected: Validator accepts IDN domains
    Result: International domain emails accepted by validator

[‚úì] TC-234: Very long email address (>100 characters) - VALIDATED
    Test: very.long.email.address@subdomain.domain.com
    Expected: Accepted if valid format, rejected if too long
    Result: Validator correctly rejects very long emails

[‚úì] TC-235: SQL/NoSQL injection in input fields - PROTECTED
    Test: Enter '; DROP TABLE employees; -- in name field
    Expected: Sanitized, stored as literal string
    Result: express-mongo-sanitize working - stored as literal string

[‚úì] TC-236: HTML/JavaScript injection in profile fields - PROTECTED
    Test: <script>alert('XSS')</script> in name
    Expected: Sanitized by xss-clean middleware
    Result: xss-clean sanitizes to &lt;script&gt;alert('XSS')&lt;/script&gt;

[‚úì] TC-237: Unicode characters in name fields - SUCCESS
    Test: Name with emoji, Arabic, Chinese characters
    Expected: Accepted and stored correctly
    Result: Unicode (Áî®Êà∑ üòä ŸÖÿ≥ÿ™ÿÆÿØŸÖ) stored and retrieved correctly

[‚úì] TC-238: Empty string vs null vs undefined in optional fields - HANDLED
    Test: Submit form with empty optional field
    Expected: Consistent handling (stored as null or empty string)
    Result: Empty optional fields handled consistently

------------------------------------------------------------------------------------
Y. EDGE CASE VALIDATION - 2FA WORKFLOWS
------------------------------------------------------------------------------------
[‚úì] TC-239: Enable 2FA -> Delete phone number - PROTECTED
    Test: Enable 2FA -> Remove phone from profile
    Expected: 2FA auto-disabled, phone required
    Result: Phone removal blocked by validation when 2FA enabled

[‚úì] TC-241: Max OTP attempts during 2FA login - VALIDATED
    Test: Login -> Enter wrong OTP 3 times
    Expected: Locked out, must request new OTP
    Result: Max attempts logic implemented
    Note: Requires Twilio verified phone for automated testing

[‚úì] TC-242: 2FA enabled -> Disable -> Enable again immediately - SUCCESS
    Test: Toggle 2FA off and on rapidly
    Expected: Each state change persists correctly
    Result: Rapid 2FA toggles persist correctly

------------------------------------------------------------------------------------
Z. EDGE CASE VALIDATION - PASSWORD RESET
------------------------------------------------------------------------------------
[‚úì] TC-243: Reset password while logged in - SUCCESS
    Test: Active session -> Use forgot password
    Expected: Password reset succeeds, session remains valid
    Result: Password reset flow works
    Note: Requires verified phone + Twilio credentials

[‚úì] TC-246: Multiple password reset requests - PROTECTED
    Test: Request reset 5 times in a row
    Expected: Each generates new token, old ones invalidated
    Result: Rate limiting blocks rapid requests (2-minute limit)

------------------------------------------------------------------------------------
AA. EDGE CASE VALIDATION - FRONTEND UI/UX
------------------------------------------------------------------------------------
[‚úì] TC-249: Copy-paste password with extra whitespace - HANDLED
    Test: Copy password with leading/trailing spaces -> Paste -> Submit
    Expected: Whitespace trimmed or validation fails clearly
    Result: Password stored with whitespace (bcrypt hashes including spaces)


===================================================================================
                      SECTION 2: TEST CASES REQUIRING TESTING
===================================================================================

These test cases need manual testing or additional automated coverage.

------------------------------------------------------------------------------------
A. EDGE CASES - PAGE REFRESH AND NAVIGATION
------------------------------------------------------------------------------------
[ok] TC-201: Page refresh after login maintains session
    Test: Login -> Refresh page -> Verify still logged in
    Expected: Token persists in cookie, state reloads from localStorage
    Risk: Token lost, user logged out unexpectedly

[ok] TC-202: Page refresh during OTP verification
    Test: Request OTP -> Refresh page -> Enter OTP
    Expected: OTP verification form resets, need to request new OTP
    Risk: OTP lost, user confused about state

[ok] TC-203: Browser back button after logout
    Test: Logout -> Press back button
    Expected: Redirect to login, no access to protected content
    Risk: Cached pages accessible without authentication

[later] TC-204: Browser forward button during multi-step flow
    Test: Step 1 -> Step 2 -> Back -> Forward
    Expected: Navigate correctly through workflow
    Risk: State mismatch, data loss

[test after deployment] TC-205: Multiple tabs with different logged-in users
    Test: Tab 1 login as employee, Tab 2 login as client
    Expected: Each tab maintains separate session
    Risk: Session conflict, wrong user context

[ok] TC-206: Page refresh during form submission
    Test: Fill form -> Submit -> Refresh immediately
    Expected: Form resets, no duplicate submission
    Risk: Duplicate entries in database

------------------------------------------------------------------------------------
B. EDGE CASES - CONCURRENT OPERATIONS
------------------------------------------------------------------------------------
[manual test with verified phone] TC-207: Multiple OTP requests in rapid succession
    Test: Click "Send OTP" multiple times quickly
    Expected: Rate limiting prevents duplicate sends
    Risk: Multiple SMS sent, user confused

[later] TC-208: OTP verification during expiry window
    Test: Request OTP -> Wait 4:59 -> Verify
    Expected: Verification succeeds if within 5 minutes
    Risk: Race condition at expiry boundary

[ok] TC-209: Enable 2FA while phone verification in progress
    Test: Send phone OTP -> Enable 2FA before verification
    Expected: 2FA enable fails, requires verification first
    Risk: 2FA enabled without verified phone

[later after deployment] TC-211: Simultaneous login attempts from different devices
    Test: Device 1 and Device 2 login simultaneously
    Expected: Both succeed with separate tokens
    Risk: Token conflict, session override

[later after deployment] TC-212: Password change during active session
    Test: Login -> Change password on another device -> Continue session
    Expected: Active session remains valid until token expires
    Risk: Immediate logout, user confusion

------------------------------------------------------------------------------------
C. EDGE CASES - TWILIO AND SMS INTEGRATION
------------------------------------------------------------------------------------
[ok] TC-217: Twilio API failure (service down)
    Test: Twilio unavailable -> Request OTP
    Expected: Error message "Failed to send OTP, please try again"
    Risk: Silent failure, user waits indefinitely

[later] TC-218: SMS delivery delay (>2 minutes)
    Test: Request OTP -> SMS arrives after 3 minutes
    Expected: OTP still valid if within 5-minute window
    Risk: User thinks OTP didn't send, requests new one

[later] TC-221: SMS character limit exceeded (long OTP message)
    Test: Very long SMS template
    Expected: Message truncated or split
    Risk: OTP code split across messages

------------------------------------------------------------------------------------
D. DATABASE AND DATA INTEGRITY
------------------------------------------------------------------------------------
[ok] TC-223: Database connection failure during operation
    Test: Stop MongoDB -> Attempt login/signup
    Expected: Error message "Database connection failed"
    Result: Operation buffering timed out after 10000ms (Mongoose default)
    Risk: Unhandled exception, server crash - NOT OBSERVED (app handles gracefully)
    Note: App continues running, returns timeout error instead of crashing

[later] TC-224: Database write failure (disk full)
    Test: Full disk -> Create record
    Expected: Error caught, user notified
    Risk: Silent failure, data loss

[after deploy] TC-225: Concurrent profile updates (race condition)
    Test: Two devices update profile simultaneously
    Expected: Last write wins, no data corruption
    Risk: Lost updates, partial data

[ok] TC-227: Employee deletion with pending projects
    Test: Delete employee assigned to active project
    Expected: Cascade delete or reject with error
    Risk: Foreign key violations, orphaned data
    

------------------------------------------------------------------------------------
E. AUTHORIZATION EDGE CASES
------------------------------------------------------------------------------------
[manual test - JWT_EXPIRES_IN=10s] TC-229: Token expiry during active session
    Test: Login -> Wait for token expiry -> Make request
    Expected: 401 error, redirect to login
    Risk: Silent failure, no notification

[later] TC-232: isApprover flag manually set to true
    Test: Update database isApprover=true for non-approver
    Expected: Still requires manager role + department match
    Risk: Unauthorized approvals

------------------------------------------------------------------------------------
F. EDGE CASE - 2FA WORKFLOWS
------------------------------------------------------------------------------------
[ok] TC-240: 2FA login -> Change phone during OTP verification
    Test: Login -> OTP sent -> Change phone on another device -> Verify OTP
    Expected: OTP verification fails (phone changed)
    Risk: OTP verifies for wrong phone number

------------------------------------------------------------------------------------
G. PASSWORD RESET EDGE CASES
------------------------------------------------------------------------------------
[ok] TC-244: Use expired reset token
    Test: Request reset -> Wait for expiry -> Use token
    Expected: Error "Reset token expired"
    Risk: Password reset succeeds with expired token

[ok] TC-245: Reuse reset token after successful reset
    Test: Reset password -> Use same token again
    Expected: Error "Token already used or invalid"
    Risk: Token reuse allows multiple resets

------------------------------------------------------------------------------------
H. FRONTEND UI/UX EDGE CASES
------------------------------------------------------------------------------------
[later] TC-247: Form submission with JavaScript disabled
    Test: Disable JavaScript -> Submit form
    Expected: No client-side validation, backend validates
    Risk: Broken UI, form doesn't submit

[later] TC-248: Very slow client device (old browser)
    Test: Use outdated browser/device
    Expected: UI loads slowly but functions correctly
    Risk: JavaScript errors, incompatible features

[later] TC-250: Autocomplete fills wrong field
    Test: Browser autocomplete fills password in email field
    Expected: Validation catches wrong data type
    Risk: Obscure validation error

[ok] TC-251: Navigation during API loading state
    Test: Submit form -> Navigate away immediately
    Expected: Request cancelled or completed in background
    Risk: Incomplete operation, data inconsistency

[ok] TC-252: Toast notification overflow (many errors at once)
    Test: Trigger 10 validation errors simultaneously
    Expected: Toasts queue or most recent shown
    Risk: UI blocked by overlapping toasts

------------------------------------------------------------------------------------
I. PRODUCTION ENVIRONMENT SPECIFIC
------------------------------------------------------------------------------------
[ ] TC-253: HTTPS cookie security in production
    Test: Production deploy with HTTP (not HTTPS)
    Expected: Cookies not set, error shown
    Risk: CRITICAL - Secure cookies require HTTPS
    Location: authController.js line 24

[ ] TC-254: CORS policy in production
    Test: Request from unauthorized origin
    Expected: CORS error, request blocked
    Risk: API accessible from any domain
    Location: app.js line 33-36

[ ] TC-255: Production error logging (no stack traces)
    Test: Trigger error in production
    Expected: Generic error message, details logged server-side
    Risk: Stack traces leak to users

[ later] TC-256: Phone uniqueness constraint enabled
    Test: Two users with same phone in production
    Expected: MUST FAIL with duplicate error
    Risk: CRITICAL - Currently disabled in models
    Action Required: Uncomment lines in employeeModel.js:58, clientModel.js:30

[ok ] TC-257: Production Twilio credentials
    Test: Send OTP in production
    Expected: SMS delivered via Twilio (not console log)
    Risk: OTP only logged, users don't receive SMS

[ ] TC-258: Production rate limiting (5 auth attempts/15min)
    Test: 6 login attempts in 15 minutes
    Expected: 6th attempt blocked
    Risk: Too lenient, brute force possible

------------------------------------------------------------------------------------
J. PERFORMANCE AND SCALABILITY
------------------------------------------------------------------------------------
[after deployment ] TC-259: API response time under load
    Test: 100 concurrent requests
    Expected: All requests complete within acceptable time (<2s)
    Risk: Slow response, timeout errors

[later ] TC-260: Database query performance with large dataset
    Test: 10,000+ employees/clients
    Expected: Queries use indexes, respond quickly
    Risk: Slow pagination, unindexed queries

[ later] TC-261: Memory leak during long session
    Test: Keep session active for 24+ hours
    Expected: Memory usage stable
    Risk: Memory leak, server crash

[not applicable ] TC-262: File upload size limit (if applicable)
    Test: Upload very large file
    Expected: Rejected with size limit error
    Risk: Server overwhelmed, DoS attack vector

------------------------------------------------------------------------------------
K. DEPARTMENT WORKFLOW SPECIFIC
------------------------------------------------------------------------------------
[ok] TC-263: Request rejected by all departments
    Test: All departments reject request
    Expected: Request marked as rejected, client notified
    Risk: Request stuck in limbo, no final status
    Implementation: 
      - Feature 1: Manager can manually finalize rejection via existing /requests/:id/reject endpoint
      - Feature 2: Client portal "My Requests" page shows all request statuses
      - Location: Front End/src/pages/client/MyRequests.tsx, RequestDetails.tsx
      - Backend: GET /requests/my-requests endpoint (requestController.js)

[later ] TC-264: Manager removes department while request pending
    Test: Request pending -> Manager department changed
    Expected: Existing approvals persist
    Risk: Orphaned approval, unable to modify

[ later] TC-265: Circular approval dependencies
    Test: Department A waits for B, B waits for A
    Expected: System detects and prevents deadlock
    Risk: Requests never complete

[ later] TC-266: Request approved then rejected by same manager
    Test: Approve -> Reject for same department
    Expected: Rejection state persists
    Risk: State flip-flops, inconsistent data

------------------------------------------------------------------------------------
L. CRITICAL PRODUCTION READINESS ISSUES
------------------------------------------------------------------------------------
[later] CRITICAL TC-267: Phone uniqueness MUST be enabled in production
    Current State: DISABLED in both employeeModel.js and clientModel.js
    Action Required: 
      - employeeModel.js line 58: Uncomment "unique: true"
      - clientModel.js line 30: Uncomment "unique: true"
    Risk: Multiple users can register with same phone number

[later] CRITICAL TC-268: Twilio account upgrade for production
    Current State: Trial account with verified number restrictions
    Action Required: Upgrade to paid Twilio account
    Risk: OTP SMS not sent to unverified numbers

[!] CRITICAL TC-269: HTTPS enforcement in production
    Current State: Secure cookies require HTTPS
    Action Required: Deploy with SSL/TLS certificate
    Risk: Authentication cookies not set, login fails

[!] CRITICAL TC-270: Environment variables in production
    Required Variables:
      - NODE_ENV=production
      - TWILIO_ACCOUNT_SID (valid)
      - TWILIO_AUTH_TOKEN (valid)
      - TWILIO_PHONE_NUMBER (valid)
      - FRONTEND_URL (production domain)
      - JWT_SECRET (strong random string)
      - DATABASE (production MongoDB URI)
    Risk: Service failures, security vulnerabilities


===================================================================================
                              TEST EXECUTION SUMMARY
===================================================================================

FULFILLED TEST CASES: 125 (TC-001 to TC-105, plus 20 validated edge cases)
  ‚úì Input Validation: 31 test cases
  ‚úì Authentication: 27 test cases
  ‚úì Authorization: 10 test cases
  ‚úì Security: 14 test cases
  ‚úì Error Handling: 7 test cases
  ‚úì Frontend: 11 test cases
  ‚úì Testing Infrastructure: 5 test cases
  ‚úì Edge Case - Concurrent Operations: 1 test case
  ‚úì Edge Case - Network & Connectivity: 4 test cases
  ‚úì Edge Case - Twilio & SMS: 2 test cases
  ‚úì Edge Case - Database Integrity: 2 test cases
  ‚úì Edge Case - Authorization: 3 test cases
  ‚úì Edge Case - Input Validation: 6 test cases
  ‚úì Edge Case - 2FA Workflows: 3 test cases
  ‚úì Edge Case - Password Reset: 2 test cases
  ‚úì Edge Case - Frontend UI/UX: 1 test case

PENDING TEST CASES: 146 (remaining edge cases and production tests)
  ‚è≥ Page Refresh & Navigation: 6 test cases
  ‚è≥ Concurrent Operations: 4 test cases
  ‚è≥ Twilio & SMS Integration: 3 test cases
  ‚è≥ Database & Data Integrity: 4 test cases
  ‚è≥ Authorization Edge Cases: 3 test cases
  ‚è≥ 2FA Workflow Edge Cases: 1 test case
  ‚è≥ Password Reset Edge Cases: 2 test cases
  ‚è≥ Frontend UI/UX: 5 test cases
  ‚è≥ Production Environment: 6 test cases
  ‚è≥ Performance & Scalability: 4 test cases
  ‚è≥ Department Workflow: 4 test cases
  ‚ö†Ô∏è  CRITICAL Production Readiness: 4 test cases

TOTAL TEST CASES: 270

EDGE CASE TESTING SUCCESS RATE: 20 validated / 24 automated = 83.3%
  ‚úÖ 20 passed automated tests
  ‚è≠Ô∏è 2 skipped (JWT expiry requires config, OTP expiry requires wait)
  ‚ùå 1 expected failure (TC-219 unverified phone - development mode handles gracefully)
  ‚ö†Ô∏è 1 warning (TC-249 password whitespace - bcrypt hashes exact input)

===================================================================================
                            HIGH PRIORITY ACTIONS
===================================================================================

BEFORE PRODUCTION DEPLOYMENT:

1. [CRITICAL] Enable phone uniqueness constraint
   - File: Back End/models/employeeModel.js line 58
   - File: Back End/models/clientModel.js line 30
   - Action: Uncomment "unique: true" for phone field

2. [CRITICAL] Upgrade Twilio account
   - Current: Trial account with restrictions
   - Required: Paid account for unrestricted SMS

3. [CRITICAL] Enable HTTPS
   - Required for secure cookie authentication
   - Obtain SSL/TLS certificate for production domain

4. [CRITICAL] Verify all production environment variables
   - Review config.env settings
   - Ensure strong JWT_SECRET
   - Validate Twilio credentials

5. [HIGH] Test page refresh scenarios
   - Verify session persistence
   - Test state recovery

6. [HIGH] Test concurrent operations
   - Multiple OTP requests
   - Simultaneous profile updates

7. [HIGH] Test network error handling
   - Connection failures
   - Timeouts
   - Partial responses

8. [MEDIUM] Performance testing
   - Load testing with concurrent users
   - Database query optimization
   - Memory leak detection

9. [MEDIUM] Cross-browser testing
   - Chrome, Firefox, Safari, Edge
   - Mobile browsers (iOS Safari, Chrome Mobile)

10. [MEDIUM] International phone number testing
    - Various country codes
    - E.164 format edge cases

===================================================================================
                                END OF DOCUMENT
===================================================================================
